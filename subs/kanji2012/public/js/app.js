// Generated by CoffeeScript 1.3.1
(function() {
  var KANJIS_TODAY, KANJIS_TOTAL, KANJI_PER_DAY;

  KANJIS_TOTAL = 2200;

  KANJI_PER_DAY = 6;

  KANJIS_TODAY = parseInt(moment().format("DDD"), 10) * KANJI_PER_DAY;

  jQuery(function() {
    var chart, data, h, m, updateProgress, vis, w;
    w = 960;
    h = 50;
    m = [5, 20, 20, 10];
    chart = bulletChart().width(w - m[1] - m[3]).height(h - m[0] - m[2]);
    data = [
      {
        ranges: [KANJIS_TOTAL],
        measures: [0],
        markers: [0]
      }
    ];
    vis = d3.select("#chart").selectAll("svg").data(data).enter().append("svg").attr("class", "bullet").attr("width", w).attr("height", h).append("g").attr("transform", "translate(" + m[3] + "," + m[0] + ")").call(chart);
    chart.duration(1000);
    setTimeout(function() {
      return vis.datum({
        ranges: [KANJIS_TOTAL],
        measures: [KANJIS_TODAY],
        markers: [0]
      }).call(chart);
    }, 100);
    updateProgress = function(value) {
      $('#kanjis_done').text(value);
      return vis.datum({
        ranges: [KANJIS_TOTAL],
        measures: [KANJIS_TODAY],
        markers: [value]
      }).call(chart);
    };
    $.getJSON('js/kanjis.json', function(kanjis_done) {
      return setTimeout(function() {
        return updateProgress(kanjis_done);
      }, 1100);
    });
    $('#kanjis_today').text(KANJIS_TODAY);
    return $('form').submit(function(e) {
      return e.preventDefault();
    });
  });

}).call(this);
